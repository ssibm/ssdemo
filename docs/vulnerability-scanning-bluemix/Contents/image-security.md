<img width="71" alt="image" src="https://media.github.ibm.com/user/20538/files/099741b0-6f73-11e8-9396-35e9e2697962"> <img width="35" alt="image" src="https://media.github.ibm.com/user/20538/files/879806f0-6f71-11e8-9d14-59cc8d78bc41">
# Image Security with Vulnerability Advisor
---

## Overview

Supported operating system images in a Bluemix repository are scanned by the **IBM Cloud Container Scanner** which uses a microservice that scans the containers in a Kubernetes cluster for risks, missing patches and other potential vulnerabilities. "_This microservice runs in the [kube-system](https://console.bluemix.net/docs/containers/cs_integrations.html#integrations) namespace_". The output of the results are provided by the [Vulnerability Advisor](https://console.bluemix.net/docs/services/va/va_index.html) reporting detailed information about the vulnerabilities of an image. 

Once an image scan is complete the Vulnerability Advisor provides a detailed report whether the image has passed a scan or whether the image is vulnerable and requires updates/patches. "_The possible vulnerabilities are updated daily from published security notices for the Docker image types_". The updated image can be downloaded to the local machine and pushed back to the repository using [docker commands](https://docs.docker.com/engine/reference/commandline/push/) to meet security requirements detected by the Vulnerability Advisor. Though, in some unique cases some images require manual update on a localhost for the reported security issues before they can be pushed back to the repository.

---
## Discoveries

A playground environment was created in Bluemix using the instruction provided in [IBM Cloud Docs](https://console.bluemix.net/docs/services/Registry/registry_setup_cli_namespace.html#registry_setup_cli_namespace) to configure and to test the functionalities of the IBM Cloud Container Scanner and to view the report provided by the Vulnerability Advisor. In this particular environment, accessed using the CLI method, a cluster **figure 1** and a namespace **figure 2** were configured and implemented. 

Using the [docker commands](https://docs.docker.com/engine/reference/commandline/push/) from the terminal, docker images were pushed to the namespace in the Bluemix environment **figure 3**. A sample report result provided by the Vulnerability Advisor below, **figure 3**, displays **httpd** image has security issues once it was scanned by the microservice. In this example, only one image, *httpd*, has a security issue while the other images have passed the security scan. 

#### Figure 1 - Cluster
<img width="1355" alt="image" src="https://media.github.ibm.com/user/20538/files/73879706-6f1d-11e8-89d5-471c0d2023e5">

#### Figure 2 - namespace Repository
<img width="457" alt="image" src="https://media.github.ibm.com/user/20538/files/8443d89a-6f20-11e8-98d3-4315a5582125">

#### Figure 3 - Docker Images Inside a namespace Repository
<img width="1003" alt="image" src="https://media.github.ibm.com/user/20538/files/a16c4654-6f21-11e8-8586-c247cc02cbfd">

The security reports are accessible via the GUI from the [Bluemix console](https://console.bluemix.net) which provides a detailed, user-friendly dashboard about the vulnerabilities of an image residing in the namespace. Furthermore, by clicking on an image in the GUI, infomation about specific vulnerabilites and how to resolve the listed security issues becomes visible the specific image. 

#### Figure 4 - Docker Images Residing in a namespace in a Private Repository 
<img width="1425" alt="image" src="https://media.github.ibm.com/user/20538/files/47beeeca-6fbe-11e8-9fbc-ebf381ecf895">

#### Figure 5 - A Docker Image with OK Status
<img width="1435" alt="image" src="https://media.github.ibm.com/user/20538/files/38d12b0a-6fbc-11e8-84a2-006aebedfa67">

For example, **figure 6**, httpd image has 6 vulnerabilities reported by the Vulnerability Advisor. In **figure 7**, the same Docker image, details 1 of 6 vulnerabilities further providing an explanation about the specific vulnerability.

#### Figure 6 - Vulnerabilities of a Docker Image
<img width="1426" alt="image" src="https://media.github.ibm.com/user/20538/files/6864ec80-6f62-11e8-8e02-8e08dfd84319">

#### Figure 7 - Detailed Information About a Specific Vulnerability 
<img width="1430" alt="image" src="https://media.github.ibm.com/user/20538/files/a8e17fa4-6f5c-11e8-93d7-eaf541c470ec">

---
## Updating Security Issues of an Image Residing in the Repository   

As mentioned earlier in this document, "_the possible vulnerabilities are updated daily from published security notices for the Docker image types_". The updated image can be downloaded to the local machine and pushed back to the repository using [docker commands](https://docs.docker.com/engine/reference/commandline/push/) to meet security requirements detected by the Vulnerability Advisor. Though, in some unique cases, some images require manual update on a localhost for the reported security issues before they can be pushed back to the repository. 

For example, in **figure 8** below, some Docker commands are provided to **push** or **pull** the particular image. Unless pushing the same image to the repository is intended for a different reason, it's important to execute the Docker **push** command once the particular image is updated.

#### Figure 8 - Docker Common CLI Commands 
<img width="1422" alt="image" src="https://media.github.ibm.com/user/20538/files/1204b7e4-6fd0-11e8-99f5-88e6f6142a31">


